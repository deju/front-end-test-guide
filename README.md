## 前端TDD

### 前端单元测试浅谈
在`TDD`中，要求开发者编写良好的测试。从<<测试驱动开发的艺术>>一书中，探索了如何真正开展的TDD工作，然而实际开展确实有一些困难。当然阅读其他开源项目的测试也能给予一些帮助。

就前端而言，单元测试可操作性相比集成测试等各种测试写起来更容易。所以可以从单测来开始TDD之路。


#### 简单的区分单元测试
- 需要访问数据库的测试不是单测
- 需要访问网络的测试不是单测
- 需要访问文件系统的测试不是单测

#### 良好的代码片段要规避哪些
良好的代码片段是单测的重点，那脏代码又是些什么呢？
- 条件逻辑过多
- 构造函数逻辑过多
- 全局变量过多
- 静态方法过多
- 不必要的代码、逻辑
- 外部依赖过多

#### TDD的要求
- 测试要快。快速运行，快速编写。
运行要足够快，否则会降低效率。比如说代码片段要求10行，超过10行就可以考虑进行分拆。每条测试运行在30ms左右。每个代码片段开发在几十秒至几分钟内（当然也有例外）
- 不可忽略失败的测试
保证测试必定通过
- 必须要重构
TDD的逻辑是`红灯(测试挂) -> 绿灯(测试通过) -> 重构(优化代码)`，在第二步的时候允许烂代码，甚至返回硬编码

#### 如何做
- 需求分析，思考实现，进行需求分拆（分拆成测试点，而不是子任务）。此时是需要考虑如何使用，考虑如何“使用”产品代码，是一个实例方法还是一个类方法，是从构造函数传参还是从方法调用传参，方法的命名，返回值等。这时其实就是在做设计，而且设计以代码来体现。此时测试为红
- 实现代码让测试用例通过，此时为绿
- 重构，然后让测试通过
- 最终达到如下状态：
    - 每个概念都被清晰的表达
    - 不允许重复代码
    - 不允许脏代码
    - 通过测试
